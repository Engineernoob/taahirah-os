<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Macintosh System Software · Portfolio Desktop</title>

    <!-- Local vendor styles -->
    <link rel="stylesheet" href="vendor/98.css" />
    <link rel="stylesheet" href="vendor/os-gui-layout.css" />
    <link rel="stylesheet" href="vendor/os-gui-windows-98.css" />
    <link rel="stylesheet" href="vendor/os-gui-windows-default.css" />

    <!-- Custom styles -->
    <link rel="stylesheet" href="style.css" />

    <!-- Fonts -->
    <link
      href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700;900&display=swap"
      rel="stylesheet"
    />
    <link rel="icon" href="icons/computer-icon.png" type="image/png" />
    <link rel="apple-touch-icon" href="icons/computer-icon.png" />
    <link rel="shortcut icon" href="icons/computer-icon.png" />
  </head>

  <body>
    <!-- Desktop -->
    <main id="desktop" role="main" aria-label="Desktop environment">
      <!-- Portfolio Icons -->
      <div class="desktop-icon" data-window="about" title="About Me">
        <img src="icons/about-me.png" alt="About Icon" />
        <span>About Me</span>
      </div>

      <div class="desktop-icon" data-window="projects" title="Projects">
        <img src="icons/projects.png" alt="Projects Icon" />
        <span>Projects</span>
      </div>

      <div class="desktop-icon" data-window="case-study" title="Case Study">
        <img src="icons/case.png" alt="Case Study Icon" />
        <span>Case Study</span>
      </div>

      <div class="desktop-icon" data-window="contact" title="Contact">
        <img src="icons/contact.jpg" alt="Contact Icon" />
        <span>Contact</span>
      </div>

      <div class="desktop-icon" data-window="skills-radar" title="Skills Radar">
        <img src="icons/skill-mac.jpg" alt="Skills Radar Icon" />
        <span>Skills Radar</span>
      </div>

      <div class="desktop-icon" data-window="resume" title="Resume">
        <img src="icons/resume.png" alt="Resume Icon" />
        <span>Resume</span>
      </div>

      <!-- Macintosh Applications -->
      <div class="desktop-icon" data-window="macdraw" title="MacDraw">
        <img src="icons/cd.png" alt="MacDraw Icon" />
        <span>MacDraw</span>
      </div>

      <div class="desktop-icon" data-window="macwrite" title="MacWrite">
        <img src="icons/book.png" alt="MacWrite Icon" />
        <span>MacWrite</span>
      </div>

      <div class="desktop-icon" data-window="calculator" title="Calculator">
        <img src="icons/mac-cal-1.jpeg" alt="Calculator Icon" />
        <span>Calculator</span>
      </div>

      <div class="desktop-icon" data-window="alarm-clock" title="Alarm Clock">
        <img src="icons/skill-mac.jpg" alt="Alarm Clock Icon" />
        <span>Alarm Clock</span>
      </div>

      <div class="desktop-icon" data-window="puzzle-game" title="Puzzle Game">
        <img src="icons/game.png" alt="Puzzle Game Icon" />
        <span>Puzzle Game</span>
      </div>

      <div class="desktop-icon" data-window="hypercard" title="HyperCard">
        <img src="icons/notepad.png" alt="HyperCard Icon" />
        <span>HyperCard</span>
      </div>

      <div class="desktop-icon" data-window="minesweeper" title="Minesweeper">
        <img src="icons/game.png" alt="Minesweeper Icon" />
        <span>Minesweeper</span>
      </div>

      <div
        class="desktop-icon pinball-icon"
        id="pinball-desktop-icon"
        data-window="pinball"
        title="Pinball Game"
      >
        <img src="icons/game.png" alt="Pinball Game Icon" />
        <span>Pinball Game</span>
      </div>

      <!-- Ada (AI Assistant) Icon -->
      <div
        class="desktop-icon"
        id="ada-icon"
        data-window="ada"
        title="Ada — Your AI Assistant"
      >
        <img src="icons/ada-icon.png" alt="Ada AI Icon" />
        <span>Ada</span>
      </div>
    </main>

    <!-- Taskbar -->
    <div id="taskbar" role="menubar" aria-label="Taskbar">
      <!-- Start Button -->
      <button
        id="start-icon"
        class="start-btn"
        title="Start"
        aria-haspopup="true"
        aria-expanded="false"
      >
        <img src="icons/start-button.png" alt="Start" />
        <span>Start</span>
      </button>

      <div id="taskbar-buttons" role="tablist" aria-label="Open windows"></div>
      <div class="taskbar-space"></div>
      <div class="taskbar-clock" id="clock" aria-live="polite"></div>
    </div>

    <!-- Start Menu -->
    <nav
      id="start-menu"
      class="window start-menu"
      hidden
      aria-label="Start Menu"
      style="
        position: fixed;
        bottom: 40px;
        left: 5px;
        width: 220px;
        z-index: 2000;
      "
    >
      <div class="title-bar">
        <div class="title-bar-text">Windows 98</div>
      </div>

      <div
        class="window-body"
        style="padding: 0; background: var(--win98-button-face)"
      >
        <ul
          class="start-menu-list"
          style="
            list-style: none;
            margin: 0;
            padding: 4px;
            display: flex;
            flex-direction: column;
            gap: 2px;
          "
        >
          <li>
            <button data-window="about" class="menu-item">
              <img src="icons/about-me.png" alt="" />
              About Me
            </button>
          </li>
          <li>
            <button data-window="projects" class="menu-item">
              <img src="icons/projects.png" alt="" />
              Projects
            </button>
          </li>
          <li>
            <button data-window="case-study" class="menu-item">
              <img src="icons/case.png" alt="" />
              Case Study
            </button>
          </li>
          <li>
            <button data-window="contact" class="menu-item">
              <img src="icons/contact.jpg" alt="" />
              Contact
            </button>
          </li>
          <li>
            <button data-window="skills-radar" class="menu-item">
              <img src="icons/skill-mac.jpg" alt="" />
              Skills Radar
            </button>
          </li>
          <li>
            <button data-window="resume" class="menu-item">
              <img src="icons/resume.png" alt="" />
              Resume
            </button>
          </li>

          <hr style="border: 1px inset #808080; margin: 4px 0" />
          
          <li>
            <button data-window="macdraw" class="menu-item">
              <img src="icons/cd.png" alt="" />
              MacDraw
            </button>
          </li>
          <li>
            <button data-window="macwrite" class="menu-item">
              <img src="icons/book.png" alt="" />
              MacWrite
            </button>
          </li>
          <li>
            <button data-window="calculator" class="menu-item">
              <img src="icons/mac-cal-1.jpeg" alt="" />
              Calculator
            </button>
          </li>
          <li>
            <button data-window="alarm-clock" class="menu-item">
              <img src="icons/skill-mac.jpg" alt="" />
              Alarm Clock
            </button>
          </li>
          <li>
            <button data-window="hypercard" class="menu-item">
              <img src="icons/notepad.png" alt="" />
              HyperCard
            </button>
          </li>
          <li>
            <button data-window="puzzle-game" class="menu-item">
              <img src="icons/game.png" alt="" />
              Puzzle Game
            </button>
          </li>
          <li>
            <button data-window="pinball" class="menu-item">
              <img src="icons/game.png" alt="" />
              Pinball Game
            </button>
          </li>
          <li>
            <button data-window="minesweeper" class="menu-item">
              <img src="icons/game.png" alt="" />
              Minesweeper
            </button>
          </li>
          <li>
            <button data-window="ada" class="menu-item">
              <img src="icons/ada-icon.png" alt="" />
              Ada Assistant
            </button>
          </li>

          <hr style="border: 1px inset #808080; margin: 4px 0" />

          <li>
            <button data-action="logout" class="menu-item">
              <img src="icons/shutdown.png" alt="" />
              <span>Log Out</span>
            </button>
          </li>
          <li>
            <button data-action="shutdown" class="menu-item shutdown">
              <img src="icons/shutdown.png" alt="" />
              <span>Shut Down...</span>
            </button>
          </li>
        </ul>
      </div>
    </nav>

    <style>
      .menu-item {
        width: 100%;
        background: var(--win98-button-face);
        border: none;
        padding: 4px 6px;
        display: flex;
        align-items: center;
        gap: 8px;
        font-family: "W95", "MS Sans Serif", sans-serif;
        font-size: 13px;
        cursor: pointer;
        text-align: left;
        color: black;
        box-shadow: inset 1px 1px 0 #fff, inset -1px -1px 0 #808080;
      }

      .menu-item:hover {
        background: #000080;
        color: white;
      }

      .menu-item img {
        width: 18px;
        height: 18px;
        image-rendering: pixelated;
      }

      .menu-item.shutdown:hover {
        background: #800000;
        color: white;
      }
    </style>

    <!-- Scripts -->
    <script src="script.js"></script>

    

    <!-- Boot + Ada Hooks -->
    <script>
      document.addEventListener("DOMContentLoaded", () => {
        // --- Boot & Login logic: only trigger once per full session
        const booted = sessionStorage.getItem("booted");
        const loggedIn = sessionStorage.getItem("loggedIn");
        const restarting = sessionStorage.getItem("restarting");
        
        if (!booted && !restarting) {
          sessionStorage.setItem("booted", "true");
          window.location.replace("boot.html");
          return;
        }
        
        // Check if user is logged in
        if (booted && !loggedIn && !restarting) {
          sessionStorage.setItem("booted", "true");
          window.location.replace("boot.html");
          return;
        }
        
        // Clear restarting flag if coming back from shutdown
        if (restarting) sessionStorage.removeItem("restarting");
        
        // Display welcome message for logged in user
        const currentUser = sessionStorage.getItem("currentUser");
        if (currentUser && !document.querySelector('.welcome-message')) {
          setTimeout(() => {
            createWelcomeMessage(currentUser);
          }, 2000);
        }

        // --- Welcome message function
        function createWelcomeMessage(username) {
          const welcomeWindow = document.createElement('div');
          welcomeWindow.className = 'window welcome-message';
          welcomeWindow.style.cssText = `
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 350px;
            z-index: 10000;
          `;
          
          welcomeWindow.innerHTML = `
            <div class="title-bar">
              <div class="title-bar-text">Welcome to TaahirahOS</div>
              <div class="title-bar-controls">
                <button aria-label="Close" onclick="this.closest('.window').remove()"></button>
              </div>
            </div>
            <div class="window-body" style="padding: 20px; text-align: center;">
              <h3 style="margin-top: 0; color: #000080;">Welcome, ${username}!</h3>
              <p style="color: #000;">Your TaahirahOS desktop is ready.</p>
              <p style="color: #000; font-size: 12px; margin-bottom: 20px;">Double-click icons to open applications.</p>
              <button class="default" onclick="this.closest('.window').remove()">OK</button>
            </div>
          `;
          
          document.body.appendChild(welcomeWindow);
          
          // Auto-close after 5 seconds
          setTimeout(() => {
            if (welcomeWindow.parentNode) {
              welcomeWindow.remove();
            }
          }, 5000);
        }

        // --- Ada AI Assistant setup
        const adaIcon = document.getElementById("ada-icon");
        if (adaIcon) {
          adaIcon.addEventListener("click", () => {
            openWindow("ada");
            if (!sessionStorage.getItem("adaPlayed")) {
              const audio = new Audio("sounds/ada-boot.mp3");
              audio.volume = 0.7;
              audio.play().catch(() => {});
              sessionStorage.setItem("adaPlayed", "true");
            }
          });
        }

        // --- Logout handling
        const logoutLink = document.querySelector("[data-action='logout']");
        if (logoutLink) {
          logoutLink.addEventListener("click", (e) => {
            e.preventDefault();
            logOut();
          });
        }

        // --- Shutdown handling
        const shutdownLink = document.querySelector("[data-action='shutdown']");
        if (shutdownLink) {
          shutdownLink.addEventListener("click", (e) => {
            e.preventDefault();
            playShutdownAndExit();
          });
        }

        // --- Auto-close Start Menu when an app launches
        document.querySelectorAll("[data-window]").forEach((btn) => {
          btn.addEventListener("click", () => {
            const menu = document.getElementById("start-menu");
            if (menu) menu.setAttribute("hidden", "");
          });
        });
      });

      // --- Logout function
      function logOut() {
        // Play logout sound
        try {
          const logoutAudio = new Audio("sounds/winxpshutdown.mp3");
          logoutAudio.volume = 0.4;
          logoutAudio.play().catch(() => {});
        } catch (err) {
          console.log('Logout sound not available');
        }
        
        // Clear login state
        sessionStorage.removeItem('loggedIn');
        sessionStorage.removeItem('currentUser');
        
        // Redirect to login/boot screen
        setTimeout(() => {
          window.location.replace('boot.html');
        }, 1500);
      }

      // --- Shutdown sound & redirect
      function playShutdownAndExit() {
        sessionStorage.setItem("restarting", "true");
        const shutdownAudio = new Audio("sounds/winxpshutdown.mp3");
        shutdownAudio.volume = 0.6;
        shutdownAudio.play().catch(() => {
          window.location.href = "shutdown.html";
        });
        shutdownAudio.addEventListener("ended", () => {
          window.location.href = "shutdown.html";
        });
      }

      // --- Fallback: if the tab closes, don’t block but play quick fade
      window.addEventListener("beforeunload", () => {
        try {
          const shutdownAudio = new Audio("sounds/winxpshutdown.mp3");
          shutdownAudio.volume = 0.25;
          shutdownAudio.play().catch(() => {});
        } catch {}
      });
    </script>
  </body>
</html>
