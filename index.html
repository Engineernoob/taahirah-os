<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Taahirah-OS · Portfolio Desktop</title>

    <!-- Local vendor styles -->
    <link rel="stylesheet" href="vendor/98.css" />
    <link rel="stylesheet" href="vendor/os-gui-layout.css" />
    <link rel="stylesheet" href="vendor/os-gui-windows-98.css" />
    <link rel="stylesheet" href="vendor/os-gui-windows-default.css" />

    <!-- Custom styles -->
    <link rel="stylesheet" href="style.css" />

    <!-- Fonts -->
    <link
      href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700;900&display=swap"
      rel="stylesheet"
    />
    <link rel="icon" href="icons/win-98-logo.png" type="image/png" />
  </head>

  <body>
    <!-- Desktop -->
    <main id="desktop" role="main" aria-label="Desktop environment">
      <div class="desktop-icon" data-window="about" title="About Me">
        <img src="icons/about-me.png" alt="About Icon" />
        <span>About Me</span>
      </div>

      <div class="desktop-icon" data-window="projects" title="Projects">
        <img src="icons/projects.png" alt="Projects Icon" />
        <span>Projects</span>
      </div>

      <div class="desktop-icon" data-window="case-study" title="Case Study">
        <img src="icons/win-98-logo.png" alt="Case Study Icon" />
        <span>Case Study</span>
      </div>

      <div class="desktop-icon" data-window="contact" title="Contact">
        <img src="icons/contact.png" alt="Contact Icon" />
        <span>Contact</span>
      </div>

      <div class="desktop-icon" data-window="skills-radar" title="Skills Radar">
        <img src="icons/computer-icon.png" alt="Skills Radar Icon" />
        <span>Skills Radar</span>
      </div>

      <div
        class="desktop-icon pinball-icon"
        id="pinball-desktop-icon"
        data-window="pinball"
        title="Pinball Game"
      >
        <img src="icons/game.png" alt="Pinball Game Icon" />
        <span>Pinball Game</span>
      </div>

      <!-- Ada (AI Assistant) Icon -->
      <div
        class="desktop-icon"
        id="ada-icon"
        data-window="ada"
        title="Ada — Your AI Assistant"
      >
        <img src="icons/ada-icon.png" alt="Ada AI Icon" />
        <span>Ada</span>
      </div>
    </main>

    <!-- Taskbar -->
    <footer id="taskbar" role="contentinfo" aria-label="Taskbar">
      <!-- Start Icon Only -->
      <img
        id="start-icon"
        src="icons/start-button.png"
        alt="Start Menu"
        title="Open Start Menu"
        style="
          height: 32px;
          width: auto;
          margin-left: 6px;
          cursor: pointer;
          image-rendering: pixelated;
        "
        aria-haspopup="true"
        aria-expanded="false"
      />

      <div id="taskbar-buttons" role="tablist" aria-label="Open windows"></div>
      <div class="taskbar-space"></div>
      <div class="taskbar-clock" id="clock" aria-live="polite"></div>
    </footer>

    <!-- Start Menu -->
    <nav
      id="start-menu"
      class="window start-menu"
      hidden
      aria-label="Start Menu"
      style="
        position: fixed;
        bottom: 38px;
        left: 6px;
        width: 220px;
        z-index: 2000;
      "
    >
      <div class="title-bar">
        <div class="title-bar-text">Taahirah-OS</div>
      </div>

      <div
        class="window-body"
        style="padding: 0; background: var(--win98-button-face)"
      >
        <ul
          class="start-menu-list"
          style="
            list-style: none;
            margin: 0;
            padding: 4px;
            display: flex;
            flex-direction: column;
            gap: 2px;
          "
        >
          <li>
            <button data-window="about" class="menu-item">
              <img src="icons/about-me.png" alt="" />
              About Me
            </button>
          </li>
          <li>
            <button data-window="projects" class="menu-item">
              <img src="icons/projects.png" alt="" />
              Projects
            </button>
          </li>
          <li>
            <button data-window="case-study" class="menu-item">
              <img src="icons/win-98-logo.png" alt="" />
              Case Study
            </button>
          </li>
          <li>
            <button data-window="contact" class="menu-item">
              <img src="icons/contact.png" alt="" />
              Contact
            </button>
          </li>
          <li>
            <button data-window="skills-radar" class="menu-item">
              <img src="icons/skills.png" alt="" />
              Skills Radar
            </button>
          </li>
          <li>
            <button data-window="pinball" class="menu-item">
              <img src="icons/game.png" alt="" />
              Pinball Game
            </button>
          </li>
          <li>
            <button data-window="ada" class="menu-item">
              <img src="icons/ada-icon.png" alt="" />
              Ada Assistant
            </button>
          </li>

          <hr style="border: 1px inset #808080; margin: 4px 0" />

          <li>
            <button data-action="shutdown" class="menu-item shutdown">
              <img src="icons/shutdown.png" alt="" />
              <span>Shut Down...</span>
            </button>
          </li>
        </ul>
      </div>
    </nav>

    <style>
      .menu-item {
        width: 100%;
        background: var(--win98-button-face);
        border: none;
        padding: 4px 6px;
        display: flex;
        align-items: center;
        gap: 8px;
        font-family: "W95", "MS Sans Serif", sans-serif;
        font-size: 13px;
        cursor: pointer;
        text-align: left;
        color: black;
        box-shadow: inset 1px 1px 0 #fff, inset -1px -1px 0 #808080;
      }

      .menu-item:hover {
        background: #000080;
        color: white;
      }

      .menu-item img {
        width: 18px;
        height: 18px;
        image-rendering: pixelated;
      }

      .menu-item.shutdown:hover {
        background: #800000;
        color: white;
      }
    </style>

    <!-- Scripts -->
    <script src="script.js"></script>

    <!-- Boot + Ada Hooks -->
    <script>
      document.addEventListener("DOMContentLoaded", () => {
        // --- Boot logic: only trigger once per full session
        const booted = sessionStorage.getItem("booted");
        const restarting = sessionStorage.getItem("restarting");
        if (!booted && !restarting) {
          sessionStorage.setItem("booted", "true");
          window.location.replace("boot.html");
          return;
        }
        // Clear restarting flag if coming back from shutdown
        if (restarting) sessionStorage.removeItem("restarting");

        // --- Ada AI Assistant setup
        const adaIcon = document.getElementById("ada-icon");
        if (adaIcon) {
          adaIcon.addEventListener("click", () => {
            openWindow("ada");
            if (!sessionStorage.getItem("adaPlayed")) {
              const audio = new Audio("sounds/ada-boot.mp3");
              audio.volume = 0.7;
              audio.play().catch(() => {});
              sessionStorage.setItem("adaPlayed", "true");
            }
          });
        }

        // --- Shutdown handling
        const shutdownLink = document.querySelector("[data-action='shutdown']");
        if (shutdownLink) {
          shutdownLink.addEventListener("click", (e) => {
            e.preventDefault();
            playShutdownAndExit();
          });
        }

        // --- Auto-close Start Menu when an app launches
        document.querySelectorAll("[data-window]").forEach((btn) => {
          btn.addEventListener("click", () => {
            const menu = document.getElementById("start-menu");
            if (menu) menu.setAttribute("hidden", "");
          });
        });
      });

      // --- Shutdown sound & redirect
      function playShutdownAndExit() {
        sessionStorage.setItem("restarting", "true");
        const shutdownAudio = new Audio("sounds/winxpshutdown.mp3");
        shutdownAudio.volume = 0.6;
        shutdownAudio.play().catch(() => {
          window.location.href = "shutdown.html";
        });
        shutdownAudio.addEventListener("ended", () => {
          window.location.href = "shutdown.html";
        });
      }

      // --- Fallback: if the tab closes, don’t block but play quick fade
      window.addEventListener("beforeunload", () => {
        try {
          const shutdownAudio = new Audio("sounds/winxpshutdown.mp3");
          shutdownAudio.volume = 0.25;
          shutdownAudio.play().catch(() => {});
        } catch {}
      });
    </script>
  </body>
</html>
